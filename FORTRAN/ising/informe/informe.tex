
\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[spanish,es-nodecimaldot]{babel}
\usepackage[T1]{fontenc}
\usepackage[intlimits]{amsmath}
\usepackage{graphicx}
\usepackage{a4wide}
\usepackage{float}
<<<<<<< HEAD
=======
\usepackage[labelfont={bf},textfont={it}]{caption}
\usepackage{subcaption}


\usepackage{hyperref}
\hypersetup{ %
colorlinks=false  % false:boxedlinks ; true:coloredlinks
} %


\usepackage{tikz}
\usetikzlibrary{trees}
\usepackage{xcolor}

\graphicspath{{imagenes/}}

\title{\textsc{Modelo de Ising en 2D} \\ \vspace{2em} \Large{Introducci贸n a la 
simulaci贸n computacional}}
\author{\small{ Pablo Bellino (pbellino@gmail.com)} \\
        \small{Luis Mar铆a Pizarro (lpizarro@cnea.gov.ar)}}

\date{Octubre de 2015}


\begin{document}

%\inputencoding{latin1}

\maketitle

\begin{abstract}
Se implement贸 el algoritmo de Metr贸polis para la simulaci贸n del modelo de Ising 
en 2D. Se calcularon las magnitudes del sistema (energ铆a, magnetizaci贸n, calor 
espec铆fico y suceptibilidad magn茅tica) en funci贸n de la temperatura, donde se 
hizo manifiesto la $T_c$ en la cual se produce el cambio de fase. Se realizaron 
an谩lisis cambiando el tama帽o de la red para analizar los efectos de borde y 
finalmente se calcularon las funciones de auto-correlaci贸n temporal de la 
energ铆a.
\end{abstract}


\section{Introducci贸n}

El modelo de Ising fue formulado como una representaci贸n idealizada de un 
material ferromagn茅tico. Se propone una red de spines con sus posiciones fijas, 
donde cada elemento podr谩 tomar s贸lo los valores $s_i=\pm1$. Se asume que la 
red es cuadrada y que la interacci贸n ocurre solamente a primeros vecinos. Bajo 
estas condiciones, se puede escribir el Hamiltoniano del sistema como:  

\begin{equation}{\label{eq:hamiltoniano}}
H = - J \sum_{\langle ij \rangle}^N s_is_j
\end{equation}

\noindent donde $\langle ij \rangle$ indica que la sumatoria se realiza con los 
sitios primeros vecinos, mientras que $J>0$ es la constante de acoplamiento de 
la interacci贸n entre spines. Se omite el t茅rmino de interacci贸n con un c谩mpo 
magn茅tico externo.

La magnetizaci贸n del sistema para un dado estado se define como:

\begin{equation}
M = \mu \sum_{i=1}^N s_i
\end{equation}

\noindent donde $\mu$ es la permeabilidad magn茅tica. Se dice que hay 
magnetizaci贸n espont谩nea cuando $\langle M \rangle \neq 0 $ en ausencia de 
campo magn茅tico externo. Para redes de dimensi贸n $d \geq 2$ esto ocurre a 
temperaturas menores a cierta temperatura cr铆tica $T_c$. Si $T>T_c$ el sistema 
ser谩 paramagn茅tico con una magnetizaci贸n media nula, mientras que para $T<T_c$ 
el sistema ser谩 ferromagn茅tico y habr谩 magnetizaci贸n espont谩nea. Este cambio de 
comportamiento del material es consecuencia de una transici贸n de fase de 
segundo orden.

Se puede demostrar \cite{chand1987} que la temperatura cr铆tica para una red 
cuadrada infinita, expresada en unidades adimensionales es:

\begin{equation}
\frac{k T_c }{J} = \frac{2}{ln(1+\sqrt{2})} \simeq 2.3
\end{equation}

Tanto el calor espec铆fico como la suceptibilidad magn茅tica del sistema se 
definen en funci贸n de derivadas respecto de la temperatura. Derivada de la 
energ铆a para el calor espec铆fico, y de la magnetizaci贸n para la suceptibilidad. 
Sin embargo, en el trabajo se utilizar谩 la relaci贸n de estas magnitudes con las 
fluctuaciones del sistema, ya que ello permite una mejor estimaci贸n de estas 
magnitudes. Entonces, el calor espec铆fico quedar谩 definido como:

\begin{equation}\label{eq:cal_teo}
C  = \frac{1}{kT^2} \left(\langle E^2\rangle - \langle E \rangle^2\right)
\end{equation}

\noindent y la suceptibilidad magn茅tica:

\begin{equation}\label{eq:suce_teo}
\chi = \frac{1}{kT} \left(\langle M^2\rangle - \langle M \rangle^2\right)
\end{equation}

\noindent siendo $k$ la constante de Boltzman.

\subsection{Desarrollo de la simulaci贸n}

Se implement贸 el algoritmo de Metr贸polis para obtener una colecci贸n 
representativa de distintos estados del sistema del ensamble can贸nico. Se 
utilizaron condiciones peri贸dicas de contorno con el fin de suprimir los 
efectos de borde del sistema. De esta manera se pretende simular el seno del 
material en un sistema infinito.

Se escribi贸 el programa \texttt{ising} de acuerdo al siguiente algoritmo:

\renewcommand{\theenumi}{\roman{enumi}}
\begin{enumerate}
	\item Se elije un estado inicial del sistema. Esto puede realizarse al 
	azar, haciendo que cada spin tome valores $s_i=\pm1$. Tambi茅n se permiti贸 
	que el estado inicial fuera leido de un archivo.
	\item Se elije aleatoriamente un spin de la red.
	\item Se calcula la energ铆a que tendr铆a el nuevo estado si se invirtiera el 
	spin seleccionado. Se calcula la diferencia de energ铆a respecto al estado 
	previo.
	\item Si la diferencia de energ铆a es negativa, se acepta el estado. 
	\item Si la deferencia de energ铆a es positiva se acepta el nuevo estado 
	propuesto con probabilidad $exp(-\Delta E/kT)$. Para ello se muestrea un 
	n煤mero $r$ al azar con distribuci贸n uniforme $\mathcal{U}(0,1)$. Si $r< 
	exp(-\Delta E/kT)$ se acepta el estado, de lo contrario es rechazado.
    \item En caso de haber sido aceptado se invierte el spin y se 
    calcula la magnetizaci贸n. Se guardan los datos de $E$ y $M$.
    \item Se vuelve al punto (\textrm{II}) hasta haber completado $K$ ciclos 
    del 
    algoritmo.
\end{enumerate}

\section{Medici贸n de observables}

En esta secci贸n se describir谩 la metodolog铆a utilizada para la estimaci贸n de 
los observables una vez termalizado el sistema a la temperatura de trabajo.

Para una determinada corrida $r$ del programa \texttt{ising}, se obtiene la 
energ铆a y la magnetizaci贸n realizando un promedio sobre todos los valores 
obtenidos en cada paso del algoritmo de Metr贸polis:

\begin{subequations}
   \begin{align}
  E^r \equiv &\frac{1}{K}\sum_{i=1}^K E^r_i 
  \label{eq:E_prom}\\
  M^r \equiv & \frac{1}{K}\sum_{i=1}^K M^r_i 
  \label{eq:M_prom}
   \end{align}
\end{subequations}

\noindent donde $K$ son la cantidad total de pasos realizados.

Las estimaciones del calor espec铆fico y de la suceptibilidad magn茅tica para una 
corrida $r$ se realizaron de manera similar, teniendo en cuenta las expresiones 
te贸ricas dadas de las ecuaciones \eqref{eq:cal_teo} y \eqref{eq:suce_teo} 
respectivamente:

\begin{equation}
 C^r \equiv  \frac{1}{kT^2} \frac{1}{\sqrt{K-1}} \sum_{i=1}^K \left(
 E_i^r - E^r \right)^2
\end{equation}

\begin{equation}
 \chi^r \equiv  \frac{1}{kT} \frac{1}{\sqrt{K-1}} \sum_{i=1}^K \left(
 M_i^r -  M^r \right)^2
\end{equation}

Para tener un resultado estad铆sticamente relevante, se efectuaron varias 
corridas con los mismos par谩metros. Esto permiti贸 obtener el resultado final de 
las magnitudes con su respectivo error. Llamando $N_r$ a la cantidad de 
repeticiones realizadas a una dada temperatura los valores medios y 
desviaciones est谩ndar se definieron como:

\begin{subequations}
\begin{align}
X & \equiv \langle X^r \rangle = \frac{1}{N_r} 
\sum_{r=1}^{N_r} X^r \\
\sigma(X) & \equiv \frac{\sigma(X^r)}{\sqrt{N_r}} =  \sqrt{\frac{1}{N_r(N_r-1)} 
\sum_{i=1}^{N_r} \left( 
 X^r -  X \right)^2}
\end{align}
\end{subequations}

\noindent donde $X^r$ puede ser cualquiera de los cuatro observables estimados 
en cada corrida: $E^r$, $M^r$, $C^r$ o $\chi^r$. En esta 煤ltima expresi贸n, se 
utiliza el hecho de que la distribuci贸n del valor medio de $X^r$ tiende a una 
Gaussiana debido al Teor茅ma Central del L铆mite.

\input{desc_system.tex}

\section{Resultados}

\subsection{Termalizaci贸n del sistema}

Para obtener resultados a una dada temperatura, se realizaron, en verdad dos 
corridas. La primera de ellas consisti贸 en llevar al sistema desde su estado 
inicial hasta el estado de equilibrio. A ete proceso se lo denomina 
termalizaci贸n. Luego, la segunda corrida comienza con el 煤ltimo estado obtenido 
aqu铆 para la parte de mediciones. En la Figura \eqref{fig:terma_01} se 
muestran algunos ejemplos de c贸mo es el proceso de termalizaci贸n en distintas 
condiciones.

\begin{figure}
	\begin{center}
	\begin{subfigure}{.49\textwidth}
		\centering
      	\includegraphics[scale=0.4]{{terma_t0.5_ei_rand}.pdf} \\
     	 \caption{$T=0.5$ Estado inicial aleatorio}\label{fig:terma.t05_rand}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
     	 \includegraphics[scale=0.4]{{terma_t5.0_ei_up}.pdf} \\
      	\caption{$T=5.0$ Estado inicial con $s_i=1$}\label{fig:terma.t50_up}
	\end{subfigure}
	\end{center}
	\caption{Proceso de termalizaci贸n con distintas temperaturas y estados 
	iniciales}
	\label{fig:terma_01}
\end{figure}

El criterio para saber cu谩ndo se lleg贸 al estado de equilibrio es f谩cil de 
obtener visualmente la evoluci贸n de la energ铆a y la magnetizaci贸n en cada 
paso el algoritmo. Sin embargo, al querer automatizar el proceso de ejecuci贸n 
del programa, se debe fijar un criterio tambi茅n autom谩tico para deteminar el 
punto de termalizaci贸n.

En este trabajo el criterio utilizado, fue realizar varias corridas a 
distintas temperaturas y distintas configuraciones iniciales, y registrar 
manualmente el n煤mero de pasos necesarios para llegar al equilibrio. Luego, 
entre todos los valors obtenidos se defini贸 que la cantidad de pasos para la 
termalizaci贸n $K_{term}$ sea diez veces el m谩ximo valor obtenido. En la 
pr谩ctica, para una red de 20x20, se tomaron $K_{term}=2E5$. En las Figuras 
\eqref{fig:terma_01} y \eqref{fig:terma_02} se muestran cuatro situaciones 
cambiando la temperatura de trabajo y el estado inicial de d贸nde se parte.

\begin{figure}
	\begin{center}
	\begin{subfigure}{.49\textwidth}
		\centering
      	\includegraphics[scale=0.4]{{terma_t3.0_ei_rand}.pdf} \\
     	 \caption{$T=3.0$ Estado inicial aleatorio}\label{fig:terma.t3_rand}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
     	 \includegraphics[scale=0.4]{{terma_t3.0_ei_up}.pdf} \\
      	\caption{$T=3.0$ Estado inicial con $s_i=1$}\label{fig:terma.t3_up}
	\end{subfigure}
	\end{center}
	\caption{Termalizaci贸n a la temperatura $T=3.0$ partiendo de dos 
	configuraciones de spines distintas}
	\label{fig:terma_02}
\end{figure}

Esta forma de obtener los pasos de termalizaci贸n resulta mucho mayor que el 
necesario, ya que en las corridas efectuadas siempre se tom贸 el estado final de 
la corrida efectuada a una temperatura anterior (salvo la primer corrida, a 
temperaturas altas, que se tom贸 un estado inicial arbitrario).

\newpage

\subsection{Dependencia con la temperatura del sistema}

En esta parte se describen los resultados obtenidos al repetir las simulaciones 
con distintas temperaturas de trabajo. El barrido de temperaturas se realiz贸 de 
forma autom谩tica con un $\Delta T = 0.1$ (en unidades adimensionales) y se 
redujo a $\Delta T = 0.02$ en la zona cercana a la temperatura cr铆tica, para 
obtener mayor detalle. En todos los casos cada corrida fue de $K=1E7$ puntos y 
se realizaon $N_r=40$ corridas por cada temperatura.

En la Figura \eqref{fig:val_medios} se muestran los resultados de la energ铆a y 
la magnetizaci贸n con sus respectivos errores para una red de spines de 20x20. 
Especialmente en el gr谩fico de la magnetizaci贸n, se hace evidente el cambio de 
fase cercano a la temperatura cr铆tica donde para valores menores, aparece 
magnetizaci贸n espont谩nea.

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{val_medios.pdf} \\
      \caption{Valores de energ铆a y magnetizaci贸 por spin, para 
      las distintas temperaturas simuladas}\label{fig:val_medios}
    \end{center}
\end{figure}

En la figura \eqref{fig:fluctuaciones} se muestran los gr谩ficos 
correspondientes al calor espec铆fico y a la suceptibilidad magn茅tica. Cerca de 
la temperatura cr铆tica se observa un aumento de ambas magnitudes 
(te贸ricamente para un sistema infinito hay una divergencia). En esa misma zona, 
se observ贸 tambi茅n un aumento del error en los estimadores, producto de las 
grandes fluctuaciones con que evolucionaba el sistema. A partir de estos 
gr谩ficos puede determinarse la temperatura cr铆tica del sistema como el m谩ximo 
de ambas curvas.

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{fluctuaciones.pdf} \\
      \caption{Valores de calor espec铆fico y suceptibilidad magn茅tica por spin 
      en funci贸n de la temperatura} \label{fig:fluctuaciones}
    \end{center}
\end{figure}

Finalmente, se muestra en la Figura \eqref{fig:aceptaciones} el porcentaje de 
aceptaciones a lo largo de todos los pasos del algoritmo de Metr贸polis, en 
funci贸n de la temperatura de trabajo. Esta curva, como es de esperar, sigue un 
comportamiento similar a la curva de energ铆a (depende intr铆nsecamente de ella). 
Se observa que a bajas temperaturas, la mayor铆a de los estados propuestos son 
rechazados, ya que el sistema prefiere tener todos sus spines en la misma 
direccion. Aumentando la temperatura, el porcentaje de aceptaciones comienza a 
incrementarse haciendo que el sistema pueda recorrer mayor cantidad de estados.

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.5]{aceptaciones.pdf} \\
      \caption{Porcentaje de aceptaciones del algoritmo de Metr贸polis en 
      funci贸n de la temperatura de trabajo}\label{fig:aceptaciones}
    \end{center}
\end{figure}

\subsection{Efectos de borde}

En la secci贸n anterior se realizaron las simulaciones considerando una matriz 
de spines de 20x20. Si bien se utilizaron condiciones peri贸dicas de contorno, 
los efectos del tama帽o finito de la red se hicieron evidente, principalemnte en 
la zona de la temperatura cr铆tica, donde se espera divergencia de $C$ y $\chi$. 
Para analizar con m谩s detalle los efectos de borde, se procedi贸 a repetir las 
mediciones anteriores, pero ahora cambiando el tama帽o de la red de spines. Se 
utilizaron redes de 10x10, 20x20, 40x40 y 100x100.

Al utilizar las redes de mayor tama帽o, y en particular la de 100x100, se 
encontr贸 que la cantidad de pasos necesarios tanto para la termalizaci贸n como 
para la medici贸n aument贸 considerablemente. Para esta simulaci贸n, cada corrida 
se realiz贸n con $K_{term}=2E6$ para la termalizaci贸n y $K=1.2E8$ puntos para 
las mediciones.

En la Figura \eqref{fig:tam_val_medios} se muestran los resultados para la 
energ铆a y magnetizaci贸n por spin en funci贸n de la temperatura para las cuatro 
redes simuladas.

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{tamano_val_medios.pdf} \\
      \caption{Energ铆a y magnetizaci贸n por spin para redes de spin de distinto 
      tama帽os}\label{fig:tam_val_medios}
    \end{center}
\end{figure}

Como primera observaci贸n, se puede decir que los efectos de borde resultan 
irrelevantes fuera de la zona cercana a la temperatura cr铆tica. Los valores de 
energ铆a ni siquiera cambian demasiado en dicha zona. En cambio, la 
magnetizaci贸n presenta mayores variaciones para las distintas redes, 
principalmente en las redes de 10x10 y 20x20. Sin embargo, la diferencia se 
vuelve exigua al comparar las redes de 40x40 y 100x100 donde los efectos de 
borde no parecen ser relevantes para la magnetizaci贸n.

En la Figura \eqref{fig:tam_fluctuaciones} se muestran los resultados obtenidos 
del calor espec铆fico y suceptibilidad magn茅tica para los cuatro tama帽os 
simulados. Al igual con con $E$ y $M$, aqu铆 los efectos de borde son m谩s 
notorios cerca de la temperatura cr铆tica.

La principal diferencia que se observa es que a medida que se aumenta el 
tama帽o, el efecto de la divergencia en $T_c$ se hace m谩s evidente. Las curvas 
son suaves para las redes de menor tama帽o, mientras que se vuelven m谩s 
agudas para las redes de mayor tama帽o. La diferencia entre las redes de 
40x40 y 100x100 se hacen notorias s贸lo muy cerca de la $T_c$ donde los valores 
de la 煤ltima de ellas aumentan a m谩s del doble.

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{tamano_fluctuaciones.pdf} \\
      \caption{Calor espec铆fico y suceptibilidad magn茅tica por spin para redes 
      de spin 
      de distintos tama帽os}\label{fig:tam_fluctuaciones}
    \end{center}
\end{figure}

\section {Evolucin de la matriz de estado de spines en funcin de la temperatura}


Para las temperaturas

\begin{figure}[ht]
	\begin{minipage}[b]{0.45\linewidth}
		\centering
		\includegraphics[width=\textwidth]{{frame5.0}.pdf}
		\caption{Temperatura 5.0}
		\label{fig:temperatura5.0}
	\end{minipage}
	\hspace{0.5cm}
	\begin{minipage}[b]{0.45\linewidth}
		\centering
		\includegraphics[width=\textwidth]{{frame3.8}.pdf}
		\caption{Temperatura 3.8}
		\label{fig:temperatura3.8}
	\end{minipage}
\end{figure}
%\begin{figure}
%	\centering
%
%\begin{subfigure}{.49\textwidth}
%	\centering
%      \includegraphics[scale=0.3]{{frame5.0}.pdf} \\
%      \caption{Temperatura 5.0}\label{fig:frame5.0}
%\end{subfigure}
%\begin{subfigure}{.49\textwidth}
%	\centering
%      \includegraphics[scale=0.3]{{frame3.8}.pdf} \\
%      \caption{Temperatura 3.8}\label{fig:frame3.8}
%\end{subfigure}
%
%\end{figure}

\begin{figure}[ht]
	\begin{minipage}[b]{0.45\linewidth}
		\centering
		\includegraphics[width=\textwidth]{{frame2.3}.pdf}
		\caption{Temperatura 2.3}
		\label{fig:temperatura2.3}
	\end{minipage}
	\hspace{0.5cm}
	\begin{minipage}[b]{0.45\linewidth}
		\centering
		\includegraphics[width=\textwidth]{{frame2.0}.pdf}
		\caption{Temperatura 2.0}
		\label{fig:temperatura2.0}
	\end{minipage}
\end{figure}


\begin{figure}[ht]
	\begin{minipage}[b]{0.45\linewidth}
		\centering
		\includegraphics[width=\textwidth]{{frame1.3}.pdf}
		\caption{Temperatura 1.3}
		\label{fig:temperatura1.3}
	\end{minipage}
	\hspace{0.5cm}
	\begin{minipage}[b]{0.45\linewidth}
		\centering
		\includegraphics[width=\textwidth]{{frame0.5}.pdf}
		\caption{Temperatura 0.5}
		\label{fig:temperatura0.5}
	\end{minipage}
%\begin{figure}[H]
%    \begin{center}
%      \includegraphics[scale=0.5]{tamano_aceptaciones.pdf} \\
%      \caption{Porcentaje de aceptaciones en el algoritmo de Metr贸polis para 
%      redes de spin de distintos tama帽os}\label{fig:tam_aceptaciones}
%    \end{center}
%\end{figure}
\newpage
\subsection{Correlaciones temporales de la energ铆a}

\begin{equation}\label{eq:corr_teo}
C_{EE}(\tau) = \frac{\langle \left[E(t+\tau)-\langle 
E\rangle\right]\left[E(t)-\langle E \rangle\right] \rangle
}{\langle E^2\rangle - \langle E \rangle ^2}
\end{equation}

El estimador utilizado para obtener la autocorrelaci贸n de la muestra discreta 
de datos fue:

\begin{equation}\label{eq:corr_est}
C_{EE}[k] = \frac{1}{\sigma^2(N_b-k)} \sum_{i=1}^{N_b - k}\left(E[i+k] - 
\langle E \rangle\right)\left(E[i]-\langle E\rangle\right)
\end{equation}

\noindent donde $N_b$ es la cantidad de puntos presentes en el bloque de datos 
seleccionado. El valor informado consisti贸 en dividir la historia temporal de 
$E[i]$ en $N_b$ bloques, calcular la auto-correlaci贸n con \eqref{eq:corr_est} 
en cada uno de ellos, y posteriormente calcular el promedio y desviaci贸n 
estandar:

\begin{subequations}
\begin{align}
\langle C_{EE}[k]\rangle &= \frac{1}{N_b} \sum_{b=1}^{N_b} C_{EE}[k]\\
\sigma(\langle C_{EE}[k]\rangle) &= \frac{\sigma(C_{EE}[k])}{\sqrt{N_b}}
\end{align}
\end{subequations}

Finalmente, asumiendo un modelo exponencial para la funci贸n de 
auto-correlaci贸n, se linealizaron los datos para realizar un ajuste y obtener 
el tiempo de correlaci贸n $\tau_c$ del sistema:

\begin{equation}
C_{EE}[k]=A e^{-t[k]/\tau_c} \qquad \Rightarrow \quad ln\left(C_{EE}[k]\right) 
= ln(A) - \frac{t[k]}{\tau_c}
\end{equation}

\subsection{An谩lisis de los resultados del c谩lculo de las correlaciones}

Aplicando la ecuaci贸n  \eqref{eq:corr_est}  para el estimador de la 
autocorrelaci贸n de la muestra discreta
se calcularon autocorrelaciones a distintas temperaturas y con distintos 
tama帽os 
de matriz de espines. Se agruparon los resultados de manera de mostrar en un 
mismo
tama帽o de matriz, diferentes temperaturas y en iguales temperaturas distintos 
tama帽os de matriz.

\subsubsection{Correlaci贸n en funci贸n de la temperatura}

En la Figura \eqref{fig:corre_20x20}, se pueden ver los resultados del c谩lculo
de correlaciones para  temperaturas $T =9.0 $, $T = 1.0 $, $T =0.8 $ y $T = 2.3 
$, en una matriz de tama帽o 20x20.
En este caso con el descenso de la temperatura se observa un aumento del valor 
del par谩metro
de correlaci贸n $\tau_{c}$.


\begin{figure}[h]
   \begin{center}
        \includegraphics[scale=0.6]{corre_temperature.png} \\
        \caption{Par谩metro de correlaci贸n  $\tau_{c}$ en funci贸n de la 
        temperatura $T$}\label{fig:corre_tempe}
    \end{center}
\end{figure}


\subsubsection{Correlaci贸n en funci贸n del tama帽o del problema}
En las Figuras \eqref{fig:corre_tamano_t2} y \eqref{fig:corre_tamano_t9}, se 
pueden 
ver los resultados del c谩lculo
de correlaciones para los tama帽os de matriz 20x20 y 100x100 para valores de $T 
= 2.3$  y $T = 9.0$. 
En los dos casos se observa un aumento del par谩metro de correlaci贸n con el 
aumento del 
tama帽o de la matriz de spines.




\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{corre_20x20.pdf} \\
      \caption{Funciones de auto-correlaci贸n temporales de la energ铆a con su 
      banda de error para distintas temperaturas (arriba). Ajuste lineal en el 
      primer tramo de las funcione para obtener el tiempo de correlaci贸n 
      (abajo)}\label{fig:corre_20x20}
    \end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\hspace{-4em}
\begin{subfigure}{.49\textwidth}
    \begin{center}
      \includegraphics[scale=0.48]{{corre_tamano_t2.3}.png} \\
      \caption{$T=2.3$}\label{fig:corre_tamano_t2}
    \end{center}
\end{subfigure}
\begin{subfigure}{.49\textwidth}
    \begin{center}
      \includegraphics[scale=0.48]{{corre_tamano_t9.0}.png} \\
      \caption{$T=9.0$}\label{fig:corre_tamano_t9}
    \end{center}
\end{subfigure}
\caption{Funciones de autocorrelaci贸n temporal de la energ铆a, con los valores 
del tiempo de correlaci贸n obtenidos. Se comparan distintos tama帽os de redes a 
distintas temperaturas}
\end{center}
\end{figure}

%\begin{figure}[H]
%    \begin{center}
%      \includegraphics[scale=0.5]{{corre_tamano_t9.0}.png} \\
%      \caption{aaa}\label{fig:corre_tamano_t9}
%    \end{center}
%\end{figure}


\input{imgs_temps.tex}

\section{Conclusiones}

Se simul贸 el modelo de Ising en 2D utilizando el algoritmo de Metr贸polis. Se 
escribieron los programas en lenguaje Fortran para el c谩lculo principal y se 
utiliz贸 Python para manejar la ejecuci贸n y procesamiento de los datos. Con los 
scripts de python fue posible ejecutar barridos de temperatura tanto en forma 
serial como paralelizada.

De las simulaciones realizadas se obtuvieron las variables f铆sicas m谩s 
relevantes del sistema en funci贸n de la temperatura. Se analiz贸 el efecto de 
borde analizando distintos tama帽os de la red de spines. Se comprob贸 que para 
las magnitudes estudiadas, no exist铆a mucha diferencia entre las redes de 40x40 
y 100x100. Se analizaron tambi茅n los tiempos de correlaci贸n existentes en la 
simulaci贸n para distintas temperaturas y distintos tama帽os de las redes.


\begin{thebibliography}{9}

\bibitem{chand1987}
  David Chandler,
  Introduction to modern statistical mechanics,
  Oxford University Press, Massachusetts,
  Vol. 1,
  1987.

\end{thebibliography}
\end{document}
