
\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[spanish,es-nodecimaldot]{babel}
\usepackage[T1]{fontenc}
\usepackage[intlimits]{amsmath}
\usepackage{graphicx}
\usepackage{a4wide}
\usepackage{float}
\usepackage[labelfont={bf},textfont={it}]{caption}
\usepackage{subcaption}


\usepackage{hyperref}
\hypersetup{ %
colorlinks=false  % false:boxedlinks ; true:coloredlinks
} %


\usepackage{tikz}
\usetikzlibrary{trees}
\usepackage{xcolor}

\graphicspath{{imagenes/}}

\title{\textsc{Modelo de Ising en 2D} \\ \vspace{2em} \Large{Introducción a la 
simulación computacional}}
\author{\small{Luis Pizarro (lpizarro@cnea.gov.ar)} \\
        \small{Pablo Bellino (pbellino@gmail.com)}}

\date{Octubre de 2015}


\begin{document}

%\inputencoding{latin1}

\maketitle

\begin{abstract}
Un resumen
\end{abstract}


\section{Introducción}

El modelo de Ising fue formulado como una representación idealizada de un 
material ferromagnético. Se propone una red de spines con sus posiciones fijas, 
donde cada elemento podrá tomar sólo los valores $s_i=\pm1$. Se asume que la 
red es cuadrada y que la interacción ocurre solamente a primeros vecino. Bajo 
estas condiciones, se puede escribir el Hamiltoniano del sistema como:  

\begin{equation}{\label{eq:hamiltoniano}}
H = - J \sum_{\langle ij \rangle}^N s_is_j
\end{equation}

\noindent donde $\langle ij \rangle$ indica que la sumatoria se realiza con los 
sitios primeros vecinos, mientras que $J>0$ es la constante de acoplamiento de 
la interacción entre spines. Se omite el término de interacción con un cámpo 
magnético externo.

La magnetización del sistema para un dado estado se define como:

\begin{equation}
M = \mu \sum_{i=1}^N s_i
\end{equation}

\noindent donde $\mu$ es la permeabilidad magnética. Se dice que hay 
magnetización espontánea cuando $\langle M \rangle \neq 0 $ en ausencia de 
campo magnético externo. Para redes de dimensión $d \geq 2$ esto ocurre a 
temperaturas menores a cierta temperatura crítica $T_c$. Si $T>T_c$ el sistema 
será paramagnético con una magnetización media nula, mientras que para $T<T_c$ 
el sistema será ferromagnético y habrá magnetización esponánea. Este cambio de 
comportamiento del material es consecuencia de una transición de fase de 
segundo orden.

Se puede demostrar \cite{chand1987} que la temperatura crítica para una red 
cuadrada infinita, expresada en unidades adimensionales es:

\begin{equation}
\frac{k T_c }{J} = \frac{2}{ln(1+\sqrt{(2)})}
\end{equation}

Tanto el calor específico como la suceptibilidad magnética del sistema se 
definen en función de derivadas respecto de la temperatura. Derivada de la 
energía para el calor específico, y de la magnetización para la suceptibilidad. 
Sin embargo, en el trabajo se utilizará la relación de estas magnitudes con las 
fluctuaciones del sistema, ya que ello permite una mejor estimación de estas 
magnitudes. Entonces, el calor específico quedará definido como:

\begin{equation}
C  = \frac{1}{kT^2} \left(\langle E^2\rangle - \langle E \rangle^2\right)
\end{equation}

\noindent y la suceptibilidad magnética

\begin{equation}
\chi = \frac{1}{kT^2} \left(\langle M^2\rangle - \langle M \rangle^2\right)
\end{equation}

\noindent siendo $k$ la constante de Boltzman.

\subsection{Desarrollo de la simulación}

Se implementó el algoritmo de Metrópolis para obtener una colección 
representativa de distintos estados del sistema del ensamble canónico. Se 
utilizaron condiciones periódicas de contorno con el fin de suprimir los 
efectos de borde del sistema. De esta manera se pretende simular el seno del 
material en un sistema infinito.

Se escribió el programa \texttt{ising} de acuerdo al siguiente algoritmo:

\renewcommand{\theenumi}{\roman{enumi}}
\begin{enumerate}
	\item Se elije un estado inicial del sistema. Esto puede realizarse al 
	azar, haciendo que cada spin tome valores $s_i=\pm1$. También se permitió 
	que el estado inicial fuera leido de un archivo.
	\item Se elije aleatoriamente un spin de la red.
	\item Se calcula la energía que tendría el nuevo estado si se invirtiera el 
	spin seleccionado. Se calcula la diferencia de energía respecto al estado 
	previo.
	\item Si la diferencia de energía es negativa, se acepta el estado. 
	\item Si la deferencia de energía es positiva se acepta el nuevo estado 
	propuesto con probabilidad $exp(-\Delta E/kT)$. Para ello se muestrea un 
	número $r$ al azar con distribución uniforme $\mathcal{U}(0,1)$. Si $r< 
	exp(-\Delta E/kT)$ se acepta el estado, de lo contrario es rechazado.
    \item En caso de haber sido aceptado se invierte el spin y se 
    calcula la magnetización. Se guardan los datos de $E$y $M$.
    \item Se vuelve al punto (\textrm{II}) hasta haber completado $K$ ciclos 
    del 
    algoritmo.
\end{enumerate}

\subsection{Medición de observables}

Para una determinada corrida, se obtiene la energía y la magnetización promedio 
de la siguiente manera:

\begin{subequations}
   \begin{align}
  E^r \equiv &\frac{1}{K}\sum_{i=1}^K E^r_i 
  \label{eq:E_prom}\\
  M^r \equiv & \frac{1}{K}\sum_{i=1}^K M^r_i 
  \label{eq:M_prom}
   \end{align}
\end{subequations}

Las estimaciones del calor específico y de la suceptibilidad magnética se 
realizaro de manera similar para cada corrida $r$:

\begin{equation}
 C^r \equiv  \frac{1}{kT^2} \frac{1}{\sqrt{K-1}} \sum_{i=1}^K \left(
 E_i^r - E^r \right)^2
\end{equation}

\begin{equation}
 \chi^r \equiv  \frac{1}{kT} \frac{1}{\sqrt{K-1}} \sum_{i=1}^K \left(
 M_i^r -  M^r \right)^2
\end{equation}

Para obtener el resultado final con su respectivo error, se hizo estadística 
con $N_r$ corridas para cada temperatura:

\begin{subequations}
\begin{align}
X & \equiv \langle X^r \rangle = \frac{1}{N_r} 
\sum_{r=1}^{N_r} X^r \\
\sigma(X) & \equiv \frac{\sigma(X^r)}{\sqrt{N_r}} =  \sqrt{\frac{1}{N_r(N_r-1)} 
\sum_{i=1}^{N_r} \left( 
 X^r -  X \right)^2}
\end{align}
\end{subequations}

\noindent donde $X^r$ puede ser cualquiera de los cuatro observables estimados 
en cada corrida $E^r$, $M^r$, $C^r$ ó $\chi^r$

\subsection{Correlaciones temporales de la energía}

\begin{equation}\label{eq:corr_teo}
C_{EE}(\tau) = \frac{\langle \left[E(t+\tau)-\langle 
E\rangle\right]\left[E(t)-\langle E \rangle\right] \rangle
}{\langle E^2\rangle - \langle E \rangle ^2}
\end{equation}

El estimador utilizado para obtener la autocorrelación de la muestra discreta 
de datos fue:

\begin{equation}\label{eq:corr_est}
C_{EE}[k] = \frac{1}{\sigma^2(N_b-k)} \sum_{i=1}^{N_b - k}\left(E[i+k] - 
\langle E \rangle\right)\left(E[i]-\langle E\rangle\right)
\end{equation}

\noindent donde $N_b$ es la cantdiad de puntos presentes en el bloque de datos 
seleccionado. El valor informado consistió en dividir la historia temporal de 
$E[i]$ en $N_b$ bloques, calcular la auto-correlación con \eqref{eq:corr_est} 
en cada uno de ellos, y posteriormente calcular el promedio y desviación 
estandar:

\begin{subequations}
\begin{align}
\langle C_{EE}[k]\rangle &= \frac{1}{N_b} \sum_{b=1}^{N_b} C_{EE}[k]\\
\sigma(\langle C_{EE}[k]\rangle) &= \frac{\sigma(C_{EE}[k])}{\sqrt{N_b}}
\end{align}
\end{subequations}


\tikzstyle{every node}=[thick,anchor=west, 
font={\scriptsize\ttfamily}, inner sep=2.5pt]
\tikzstyle{selected}=[draw=blue,fill=blue!10]
\tikzstyle{root}=[draw=blue, fill=blue!30]

\begin{figure}[H]\label{fig:arbol.dir}
\begin{center}
\begin{tikzpicture}[%
    scale=.7,
    grow via three points={one child at (0.5,-0.65) and
    two children at (0.5,-0.65) and (0.5,-1.2)},
    edge from parent path={(\tikzparentnode.south) |- (\tikzchildnode.west)}]
  	\node [root] {bin}
  	child { node [red] {ising}}
  	child { node [red] {corridas\_paralelo.py}}
  	child { node [red] {corridas.py}}
  	child { node {tablas\_temperatura.dat}}
    child { node [selected] {0.5\_tmpfolder}
      child { node {parametros.dat}}
      child { node {runs\_estadistica.dat}}
      child { node [selected] {RUN00}
	     child { node {val\_medios.dat}}
	     child { node {estado.dat}}
	     child { node {ultimo\_estado.dat}}
      }
      child { node at(0,-1.8) [selected] {RUN01}}
      child { node at(0,-1.9) [selected] {RUN02}}
      child { node at (0,-2.0) {\dots}}
    }       
    child { node at (0,-5.5) [selected]{0.6\_tmpfolder}}
    child { node at (0,-5.8)[selected] {0.7\_tmpfolder}}
    child { node at (0,-6.1) {\dots}};
\end{tikzpicture}
\end{center}
\caption{Esquema de carpetas y archivos que se obtienen al realizar una corrida 
completa haciendo estadísticas en cada temperatura.}
\end{figure}]

\input{desc_system.tex}

\subsection{Termalización del sistema}

\begin{figure}
	\begin{center}
	\begin{subfigure}{.49\textwidth}
		\centering
      	\includegraphics[scale=0.4]{{terma_t0.5_ei_rand}.pdf} \\
     	 \caption{$T=0.5$ Estado inicial aleatorio}\label{fig:terma.t05_rand}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
     	 \includegraphics[scale=0.4]{{terma_t5.0_ei_up}.pdf} \\
      	\caption{$T=5.0$ Estado inicial con $s_i=1$}\label{fig:terma.t50_up}
	\end{subfigure}
	\end{center}
	\caption{Proceso de termalización con distintas temperaturas y estados 
	iniciales}
\end{figure}

\begin{figure}
	\begin{center}
	\begin{subfigure}{.49\textwidth}
		\centering
      	\includegraphics[scale=0.4]{{terma_t3.0_ei_rand}.pdf} \\
     	 \caption{$T=3.0$ Estado inicial aleatorio}\label{fig:terma.t3_rand}
	\end{subfigure}
	\begin{subfigure}{.49\textwidth}
		\centering
     	 \includegraphics[scale=0.4]{{terma_t3.0_ei_up}.pdf} \\
      	\caption{$T=3.0$ Estado inicial con $s_i=1$}\label{fig:terma.t3_up}
	\end{subfigure}
	\end{center}
	\caption{Termalización a la temperatura $T=3.0$ partiendo de dos 
	configuraciones de spines distintas}
\end{figure}

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.6]{val_medios.pdf} \\
      \caption{Valores de energía y magnetizació por spin, para 
      las distintas temperaturas simuladas}\label{fig:val_medios}
    \end{center}
\end{figure}


\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.6]{fluctuaciones.pdf} \\
      \caption{Valores de calor específico y suceptibilidad magnética por spin 
      en función de la temperatura} \label{fig:fluctuaciones}
    \end{center}
\end{figure}

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.5]{aceptaciones.pdf} \\
      \caption{Porcentaje de aceptaciones del algoritmo de Metrópolis en 
      función de la temperatura de trabajo}\label{fig:aceptaciones}
    \end{center}
\end{figure}


\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{tamano_val_medios.pdf} \\
      \caption{Energía y magnetización por spin para redes de spin de distinto 
      tamaños}\label{fig:tam_val_medios}
    \end{center}
\end{figure}

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.7]{tamano_fluctuaciones.pdf} \\
      \caption{Calor específico y suceptibilidad magnética para redes de sping 
      de distintos tamaños}\label{fig:tam_fluctuaciones}
    \end{center}
\end{figure}

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.5]{tamano_aceptaciones.pdf} \\
      \caption{Porcentaje de aceptaciones en el algoritmo de Metrópolis para 
      redes de spin de distintos tamaños}\label{fig:tam_aceptaciones}
    \end{center}
\end{figure}

\begin{figure}[H]
    \begin{center}
      \includegraphics[scale=0.5]{corre_20x20.png} \\
      \caption{Funciones de auto-correlación temporales de la energía con su 
      banda de error para distintas temperaturas (arriba). Ajuste lineal en el 
      primer tramo de las funcione para obtener el tiempo de correlación 
      (abajo)}\label{fig:corre_20x20}
    \end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\hspace{-4em}
\begin{subfigure}{.49\textwidth}
    \begin{center}
      \includegraphics[scale=0.48]{{corre_tamano_t2.3}.png} \\
      \caption{$T=2.3$}\label{fig:corre_tamano_t2}
    \end{center}
\end{subfigure}
\begin{subfigure}{.49\textwidth}
    \begin{center}
      \includegraphics[scale=0.48]{{corre_tamano_t9.0}.png} \\
      \caption{$T=9.0$}\label{fig:corre_tamano_t9}
    \end{center}
\end{subfigure}
\caption{Funciones de autocorrelación temporal de la energía, con los valores 
del tiempo de correlación obtenidos. Se comparan distintos tamaños de redes a 
distintas temperaturas}
\end{center}
\end{figure}

%\begin{figure}[H]
%    \begin{center}
%      \includegraphics[scale=0.5]{{corre_tamano_t9.0}.png} \\
%      \caption{aaa}\label{fig:corre_tamano_t9}
%    \end{center}
%\end{figure}


\input{imgs_temps.tex}

\begin{thebibliography}{9}

\bibitem{chand1987}
  David Chandler,
  Introduction to modern statistical mechanics,
  Oxford University Press, Massachusetts,
  Vol. 1,
  1987.

\end{thebibliography}
\end{document}
