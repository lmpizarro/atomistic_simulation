
\documentclass[a4paper,12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[spanish,es-nodecimaldot]{babel}
\usepackage[T1]{fontenc}
\usepackage[intlimits]{amsmath}
\usepackage{graphicx}
\usepackage{a4wide}
\usepackage{float}
\usepackage[labelfont={bf},textfont={it}]{caption}
\usepackage{subcaption}


\usepackage{hyperref}
\hypersetup{ %
colorlinks=false  % false:boxedlinks ; true:coloredlinks
} %


\usepackage{tikz}
\usetikzlibrary{trees}
\usepackage{xcolor}

\graphicspath{{imagenes/}}

\title{\textsc{Dinámica Molecular} \\ \vspace{2em} \Large{Introducción a la 
simulación computacional}}
\author{\small{ Pablo Bellino (pbellino@gmail.com)} \\
        \small{Luis María Pizarro (lpizarro@cnea.gov.ar)}}

\date{Octubre de 2015}


\begin{document}

%\inputencoding{latin1}

\maketitle

\begin{abstract}
Se implementó el algoritmo de dinámica molecular 
\end{abstract}


\section{Introducción}

Hamiltoniano

\begin{equation}\label{eq:hamiltoniano}
  \mathcal H({\bf r},{\bf p}) = \sum_{i=1}^{N} \frac{p_i^2}{2m} + \sum_{i=1}^N \sum_{j>i} \phi (r_{ij})
\end{equation}

Potencial de Lennard-Jones:

\begin{equation}\label{eq:pot_LJ}
  \phi (r) = 4\epsilon\left[\left(\frac{\sigma}{r}\right)^{12} -\left(\frac{\sigma}{r}\right)^{6}\right]
\end{equation}

Potencial truncado y desplazado

\begin{equation}\label{eq:pot_cs}
  \phi_{cs}(r) = 
  \begin{cases}
	  \phi(r)- \phi(r_c) \quad \text{si } r \leq r_c \\
	  0 \hspace{2.4cm} \text{si } r > r_c
  \end{cases}
\end{equation}

Unidades reducidas

\begin{table}
	\label{tb:unidades}
	\begin{center}
\begin{tabular}{ccc}
	\hline
	{\bf Magnitud} & {\bf Símbolo} & {\bf Unidad} \\ \hline
	 Distancia & $L^*$& $\sigma$ \\ 
	Energía &$E^*$& $\epsilon$ \\ 
	Masa &$m^*$& $m$ \\ 
	Tiempo &$t^*$& $\sigma\sqrt{m/\epsilon}$ \\ 
	Temperatura &$T^*$& $k_b/\epsilon$ \\ 
	Presión &$p^*$& $\epsilon/\sigma^3$ \\ 
	Fuerza &$F^*$& $\epsilon/\sigma$ \\ 
	\hline 
\end{tabular}
\end{center} 
\caption{Unidades reducidas utilizadas en la simulación}
\end{table}

Presión instantánea:

\begin{equation}\label{eq:pres}
p(t) = \rho T  - \frac{1}{3V} \sum_{i=1}^N \sum_{j>i} r_{ij} \frac{\phi(r_{ij})}{dr}
\end{equation}

Temperatura instantánea:

\begin{equation}\label{eq:tempe}
 T(t) = \frac{1}{3N-3} \sum_{i=1}^{N} m {\bf v_i}^2
\end{equation}

Termostato Langevin:

\begin{equation}\label{eq:termo}
 F_i^{\it lang} = - \gamma  v_i + \sqrt{\frac{2\gamma T}{\Delta t}} \mathcal N(0,1)
\end{equation}



\input{desc_system.tex}

\section{Resultados}

En esta sección se muestran los resultados obtenidos durante las distintas 
corridas del programa. Para facilitzar su análisis se dividieron los resultados 
en dos partes. En la primera de ellas se realizó un barrido de temperaturas 
dejando una densidad de partículas fija, mientras que en la segunda se hizo un 
barrido de densidad a una temperatura fija.

En la Figura \eqref{fig:fases} se muestran esquemáticamente (en rojo) ambos 
barridos sobre el diagrama de fases del sistema de Lennard-Jones. Esta figura 
permitirá, a su vez, analizar los resultados obtenidos dependiendo en qué parte 
del diagrama se realizó cada simulación.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.1]{fases.png} \\
	\caption{Diagrama de fases del sistema de Lennard-Jones junto conl as 
	indicaciones sobre los distintos estados simulados (en rojo). Gráfico 
	original extraido de \cite{hansenverlet1969}}\label{fig:fases}
\end{figure}

\subsection{Verificación del termostato de Langevin}

Antes de realizar el estudio sistemático variando los parámetros, se realizó 
una comprobacióń de que el termostato de Langevin estuviese bien implementado.

La primera verificación se realizó analizando el gráfico de la temperatura en 
función del tiempo para el sistema en equilibrio. Se realizó una corrida con 
$\rho^*=0.8$ y $T^*=1.0$. En la Figura \eqref{fig:termo_tempe} se muestran el 
resultado obtenido.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{termo_tempe.pdf} \\
	\caption{Temperatura instantánea en función del tiempo para $T^*=1.0$ 
	utilizando el termostato de Langevin}\label{fig:termo_tempe}
\end{figure}

El comportamiento de la temperatura es el esperado, con un valor medio 
alrededor del valor fijado de temperatura y una fluctuación debida a la 
característica propia del termostato.

Es posible, sin embargo, realizar una validación más detallada analizando si la 
fluctuaciones obtenidas son las que corresponden con la física del problema. En 
particular, se analizó la fluctuación de la componente de velocidad de una 
partícula arbitraria a lo largo de una simulación.

Para un sistema en quilibrio en el ensamble canónico, es posible demostrar que 
el módulo cuadrado de la velocidad tiene una distribución de Maxwell-Boltzmann, 
de lo cual se deduce que cada componente de la velocidad posee una distribución 
Gaussiana dada por:

\begin{equation}\label{eq:dist_gauss}
f (v_i) =
\sqrt{\frac{m}{2 \pi k_bT}} \exp \left[ \frac{-mv_i^2}{2k_bT} \right]
\end{equation}

\noindent de donde se deduce que la varianza de dicha distribución será (en unidades reducidas):

\begin{equation}\label{eq:termo_sigma}
\sigma^2(v^*_i) = T^*
\end{equation}

Para implementar esta validación, se eligió arbitrariamente una partícula, y se 
registró una componente arbitraria de su velocidad a lo largo de toda la 
simulación. Se realizó el histograma correspondiente y se ajusaron los datos 
obtenidos con una función Gaussiana. En la Figura \eqref{fig:termo_histo} se 
muestran los resultados obtenidos. Se omitió la normalización del histograma ya 
que no era relevante para el presente análisos.

\begin{figure}[H]\label{fig:termo_histo}
  \centering
\includegraphics[scale=0.6]{termo_histograma.pdf} \\
\vspace{-2em}
\caption{Histograma de la componente de velocidad de una partícula con el correspondiente ajuste Gaussiano para $T^*=1.0$.}\label{fig:termo_histo}
\end{figure}

La distribución de velocidades obtenida concuerda a simple vista con una 
distribución Gaussiana, y la varianza estimada a partír del ajuste fue de 
$\sigma^2(v_x^*) = 1.011$. Los resultados encontrados con este análisis 
permiten indicar que la implementación del termostato de Langevin es correcta.
	

\subsection{Barrido de temperatura a densidad constante}

En este punto se muestran los resultados obtenidos al realizar distintas 
corridas dejando la densidad constante en $\rho^*=0.3$ y cambiando la 
temperatura en el rango $[0.7\, , \, 1.4]$ con pasos de $dT=0.05$. Los 
parámetros utilizados para esta simulación fueron $N_{medición} = 5\,10^6$, 
$N_{run} = 20$, y el resto similares a los descriptos anteriormente.

En la Figura \eqref{fig:temp} se muestran los resultados más relevantes de 
estas simulaciones. En la Figura \eqref{fig:temp_p} se realiza el gráfico de 
los valores medios de la presión para cada temperatura. Los valores de 
temperatura graficados fueron los obtenidos a través de las mediciones, con sus 
respectivos errores.

Se compararon los resultados obtenidos con los valores de referencia en 
\cite{johnson1993} obteniéndose similares valores (no todos los valores estaban 
disponibles en las tablas de referencia, se interpolaron puntos cuando fue 
necesario). Se tuvo la precaución de utilizar el mismo radio de corte ($r_c = 4 
\sigma$) para que la comparación sea válida, sin embargo la cantidad de 
particulas utilzada en la referencia fue de $864$ mientras que la del presente 
trabajo fue de $200$.

\begin{figure}[H]
	\centering
	\hspace{-4em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.47]{{temperatura_p.vs.T}.pdf} \\
		\caption{Presión vs. temperatura}\label{fig:temp_p}
	\end{subfigure}
	\hspace{0.9em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.47]{{temperatura_sp.vs.T}.pdf} \\
		\caption{Desviación estándar de la presión}\label{fig:temp_sp}
	\end{subfigure}
	\caption{Valores medios y desviación estándar de la presión para distintas temperaturas con $\rho^*=0.3$}\label{fig:temp}
\end{figure}

En la Figura \eqref{fig:temp_sp} se grafica la desviación estandar de la 
presión $\sigma(p) = \sqrt{\langle p^2 \rangle - \langle p \rangle^2}$ en 
función de la temperatura. Se observa que posee un mínimo alrededor de 
$T^*=1.1$, que corresponde a un punto dentro de la zona de coexistencia de 
fases líquida y gaseosa.



\subsubsection{Visualización}

Utilizando el programa de visualización VMD se analizaron algunas de las 
configuraciones características de estas simulaciones. En particular, se 
eligieron los dos valores extremos de temperatura del intervalo recorrido 
$T^*=0.7$ y $T^*=1.4$, ambos con $\rho^*=0.3$. Observando el diagrama de fases 
de la Figura \eqref{fig:fases}, el primero de dichos puntos se encuentra en la 
zona de coexistencia líquido-gas y el segundo en la zona de líquido. En la 
Figura \eqref{fig:vmd_rho} se muestran los gráficos obtenidos en las dos 
configuraciones analizadas.

\begin{figure}[H]
	\centering
	\hspace{-4em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.3]{{vmd_t0.7_rho0.3}.png} \\
		\caption{$T^* = 0.7$   -  $\rho*=0.3$}\label{fig:vmd_rho_1}
	\end{subfigure}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.3]{{vmd_t1.4_rho0.3}.png} \\
		\caption{$T^* = 1.4$   -  $\rho*=0.3$}\label{fig:vmd_rho_2}
	\end{subfigure}
	\caption{Configuraciones características para dos temperaturas distintas 
	con una densidad fija en $\rho^*=0.3$}\label{fig:vmd_rho}
\end{figure}

En la Figura \eqref{fig:vmd_rho_1} se manifestó claramente la coexistencia 
entre las fases líquida y gaseosas. La mayoría de las partículas se mantuvieron 
agrupadas formando la zona de lúquido (parte inferior del gráfico) mientras que 
algunas de ellas, al llegar a los bordes 
podían desprenderse y migrar libremente por el resto de la caja, en la zona 
gaseosa (parte superior en el gráfico).

En la Figura \eqref{fig:vmd_rho_2} todas las partículas se mantuvieron 
agrupadas formando una única zona de fase líquida.


\subsection{Barrido de densidad a temperatura constante}

$N_{medición} = 1\,10^7$, $N_{run} = 28$

\begin{figure}[H]
	\centering
	\hspace{-4em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.47]{{densidad_p.vs.rho}.pdf} \\
		\caption{Presión vs. densidad}\label{fig:rho_p}
	\end{subfigure}	
	\hspace{0.9em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.47]{{densidad_sp.vs.rho}.pdf} \\
		\caption{Desviación estándar de la presión}\label{fig:rho_sp}
	\end{subfigure}
	
	\caption{Valores medios y desviación estándar de la presión para distintas densidades con $T^*=1.1$}\label{fig:rho}
\end{figure}



\begin{figure}[H]
	\centering
	\hspace{-4em}
	\begin{subfigure}{.33\textwidth}
		\centering
		\includegraphics[scale=0.3]{{vmd_t1.1_rho0.001}.png} \\
		\caption{$T^* = 1.1$   -  $\rho*=0.001$}\label{fig:vmd_temp_1}
	\end{subfigure}
	\hspace{0.9em}
	\begin{subfigure}{.33\textwidth}
		\centering
		\includegraphics[scale=0.3]{{vmd_t1.1_rho0.8}.png} \\
		\caption{$T^* = 1.1$   -  $\rho*=0.8$}\label{fig:vmd_temp_2}
	\end{subfigure}
		\begin{subfigure}{.33\textwidth}
			\centering
			\includegraphics[scale=0.3]{{vmd_t1.1_rho2.0}.png} \\
			\caption{$T^* = 1.1$   -  $\rho*=2.0$}\label{fig:vmd_temp_3}
		\end{subfigure}
	\caption{Temperaturas bajas}\label{fig:vmd_temp}
\end{figure}

\subsection{Función de correlación entre pares $g(r)$}

\begin{figure}[H]
	\centering
	\hspace{-4em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.46]{{gr_r0.3}.pdf} \\
		\caption{$g(r)$ para distintas temperaturas}\label{fig:gr_1}
	\end{subfigure}
	\hspace{0.1em}
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[scale=0.46]{{gr_t1.1}.pdf} \\
		\caption{$g(r)$ para distintas densidades}\label{fig:gr_2}
	\end{subfigure}
	
	\caption{Temperaturas bajas}\label{fig:gr}
\end{figure}

\section{Conclusiones}

\begin{thebibliography}{9}

\bibitem{chand1987}
  David Chandler,
  Introduction to modern statistical mechanics,
  Oxford University Press, Massachusetts,
  Vol. 1,
  1987.

\bibitem{allenTildesley1987}
  M. P. Allen, D. J. Tildesley
  Computer Simulations of Liquids
  Clarendon Press, Oxford
  1987

\bibitem{frenkelSmit2002}
  Daan Frenkel, Berend Smit
  Understanding Molecular Simulations From Algorithms to Applications
  Academic Press
  2002
  
\bibitem{hansenverlet1969}
   Hansen, Jean-Pierre, Loup Verlet
   Phase transitions of the Lennard-Jones system
   Physical Review
   Vol 184, (1), pg. 151
   1969
   
\bibitem{johnson1993}
   Johnson Karl , Zollweg John, Gubbins Keith  
   The Lennard-Jones equation of state revisited
   Molecular Physics
   Vol 78, (3), pg. 591-618
   1993
\end{thebibliography}
\end{document}
